<html>

<head>

  <title>Regexper</title>

</head>

<body>

  <h1>Regexper</h1>
  <span>You thought you only had two problems...</span>

  <form id="regexp_form" method="POST" action="/parse">
    <input id="regexp_input" type="text" /><button type="submit">Draw</button>
  </form>

  <div id="error"></div>

  <div id="paper-container"></div>

  <script src="/assets/raphael-min.js"></script>
  <script src="/assets/require.js"></script>
  <script src="/assets/microajax.js"></script>

  <script>
    require.config({
        baseUrl: '/assets'
    });

    (function() {
      var form = document.getElementById('regexp_form'),
        input = document.getElementById('regexp_input'),
        error = document.getElementById('error'),
        paper_container = document.getElementById('paper-container');

      form.onsubmit = function() {
        paper_container.innerHTML = '';
        error.innerHTML = '';

        new microAjax(form.action, function(text) {
          if (this.request.status == 200) {
            require(['regexper'], function(Regexper) {
                Regexper.draw(paper_container, JSON.parse(text));
            });
          } else if (this.request.status == 400) {
            error.innerHTML = JSON.parse(text).error;
          }
        }, input.value);

        return false;
      };
    }());
  </script>

</body>

</html>
